#
# fstab
#

- name: "fstab | configure"
  mount:
  args:
    src: "{{ item.dev }}"
    name: "{{ item.dir }}"
    fstype: "{{ item.fstype }}"
    opts: "{{ item.opts }}"
    state: "mounted"
  with_items: fstab
  tags: [fileserver, fstab]

#
# samba
#

- name: "samba | install"
  pacman: "name=samba state=present"
  notify: "restart samba"
  tags: [fileserver, samba]

- name: "samba | configure"
  template: "src=smb.conf.j2 dest=/etc/samba/smb.conf"
  notify: "restart samba"
  tags: [fileserver, samba]

#
# nfs
#

- name: "nfs | install"
  pacman: "name=nfs-utils state=present"
  notify: "restart nfs"
  tags: [fileserver, nfs]

- name: "nfs | configure daemons"
  copy:
    src: "{{ item }}"
    dest: "/etc/conf.d"
  with_items:
  - nfs-server.conf
  - nfs-common.conf
  notify: "restart nfs"
  tags: [fileserver, nfs]

- name: "nfs | configure exports"
  template:
    src: exports.j2
    dest: /etc/exports
  notify: "restart nfs"
  tags: [fileserver, nfs]

#
# cups
#

#
# sane
#

###

- name: "flush handlers"
  meta: flush_handlers
  tags: [fileserver, samba]

